#include "stdafx.h"

#include <iostream>
#include <string>

#include <Windows.h>

using namespace std;

char* getArg(_TCHAR* arg) {
	int argLength = wcslen(arg);
	int retLength = WideCharToMultiByte(CP_ACP, 0, arg, argLength, NULL, 0, NULL, NULL); // get required length
	char* ret = new char[retLength + 1];
	WideCharToMultiByte(CP_ACP, 0, arg, argLength, ret, retLength, NULL, NULL);

	ret[retLength] = '\0';

	return ret;
}

int _tmain(int argc, _TCHAR* argv[])
{
	for (int i=0; i<argc; i++) {
		char* arg = getArg(argv[i]);
		cout << "argv[" << i << "]=" << arg << endl;
		delete[] arg;
	}

	char* key = "anumericoiv";
	if (argc < 2) {
		cerr << "c'est pas bon" << endl;
	} else {
		char* arg = getArg(argv[1]);
		cout << "key: " << key << " argv[1]: " << arg << endl;
		if (!strcmp(key, arg)) {
			cout << "gg" << endl;
		} else {
			cerr << "c'est toujouts pas bon, tri agun" << endl;
		}
		delete[] arg;
	}
	return 0;
}

